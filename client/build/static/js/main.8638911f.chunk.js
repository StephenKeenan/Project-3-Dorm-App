(this["webpackJsonpmern-passport-template-client"]=this["webpackJsonpmern-passport-template-client"]||[]).push([[0],{39:function(e,t,s){},59:function(e,t,s){},65:function(e,t,s){"use strict";s.r(t);var a=s(1),c=s(29),n=s(32),r=s(14),i=s(5),l=s(30),o=s.n(l),d="GET_ERRORS",j="USER_LOADING",b="SET_CURRENT_USER",h={isAuthenticated:!1,user:{},resetSuccess:!1,loading:!1},u={},p=function(e){var t,s=Object.keys(e),a=Object.values(e),c={};return s.forEach((function(e,s){t=Object(i.a)(Object(i.a)({},t),{},Object(r.a)({},e,a[s][1]))})),a.forEach((function(e,t){c=Object(i.a)(Object(i.a)({},c),{},Object(r.a)({},s[t],e[0]))})),[function(e,t){var a=!1,n={},r={};return s.forEach((function(s,i){var l=c[s],o=e[s];r=l(o,t),a=a||r!==o,n[s]=r})),a?n:e},t]}({auth:[function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case b:return Object(i.a)(Object(i.a)({},e),{},{isAuthenticated:!o()(t.payload),user:t.payload});case j:return Object(i.a)(Object(i.a)({},e),{},{loading:!0});default:return e}},h],error:[function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case d:return t.payload;default:return e}},u]}),x=s(0),m=Object(a.createContext)();function O(e){var t=Object(a.useReducer)(p[0],p[1]),s=Object(n.a)(t,2),c={state:s[0],dispatch:s[1]};return Object(x.jsx)(m.Provider,{value:c,children:e.children})}s(39);var f=s(4),v=s(2),g=s(15),w=s.n(g),N=s(10),y=s.n(N),R=function(e){e?y.a.defaults.headers.common.Authorization=e:delete y.a.defaults.headers.common.Authorization},k=function(e){return{type:b,payload:e}},E=function(e){return{type:d,payload:e.response.data}},S=function(e){return function(t){localStorage.removeItem("jwtToken"),R(!1),t(k({})),e.push("/login")}},C=(s(59),function(e){return Object(x.jsx)("div",{className:"navbar-fixed",children:Object(x.jsx)("nav",{className:"z-depth-0",children:Object(x.jsx)("div",{className:"nav-wrapper white",children:Object(x.jsxs)(f.b,{to:"/",className:"col s5 brand-logo center black-text",style:{fontFamily:"monospace"},children:[Object(x.jsx)("i",{className:"material-icons",children:"code"})," MERN"]})})})})}),T=function(e){var t=Object(a.useContext)(m).state;return console.log({state:t,props:e}),Object(x.jsx)("div",{className:"container valign-wrapper",style:{height:"75vh"},children:Object(x.jsx)("div",{className:"row",children:Object(x.jsxs)("div",{className:"col s12 center-align",children:[Object(x.jsxs)("h4",{children:[Object(x.jsx)("b",{children:"Build"})," a login/auth app with the "," "," ",Object(x.jsx)("span",{style:{fontFamily:"monospace"},children:"MERN"})," stack from scratch"]}),Object(x.jsx)("p",{className:"flow-text grey-text text-darken-1",children:"Create a (minimal) full-stack app with user authentication via passport and JWTs"}),Object(x.jsx)("br",{}),Object(x.jsx)("div",{className:"col s6",children:Object(x.jsx)(f.b,{to:"/register",className:"btn btn-large waves-effect waves-light hoverable blue accent-3",style:{width:"140px",borderRadius:"3px",letterSpacing:"1.5px"},children:"Register"})}),Object(x.jsx)("div",{className:"col s6",children:Object(x.jsx)(f.b,{to:"/login",className:"btn btn-large btn-flat waves-effect white black-text",style:{width:"140px",borderRadius:"3px",letterSpacing:"1.5px"},children:"Login"})})]})})})},F=s(11),L=s.n(F),A=function(e){var t=Object(a.useContext)(m),s=t.state,c=t.dispatch,n=s.error,r=Object(a.useRef)(),i=Object(a.useRef)(),l=Object(a.useRef)(),o=Object(a.useRef)();Object(a.useEffect)((function(){s.auth.isAuthenticated&&e.history.push("/dashboard")}),[s,e]);return Object(x.jsx)("div",{className:"container",children:Object(x.jsx)("div",{className:"row",children:Object(x.jsxs)("div",{className:"col s8 offset-s2",children:[Object(x.jsxs)(f.b,{to:"/",className:"btn-flat waves-effect",children:[Object(x.jsx)("i",{className:"material-icons left",children:"keyboard_backspace"})," Back to home"]}),Object(x.jsxs)("div",{className:"col s12",style:{paddingLeft:"11.250px"},children:[Object(x.jsxs)("h4",{children:[Object(x.jsx)("b",{children:"Register"})," below"]}),Object(x.jsxs)("p",{className:"grey-text text-darken-1",children:["Already have an account? ",Object(x.jsx)(f.b,{to:"/login",children:"Login"})]})]}),Object(x.jsxs)("form",{noValidate:!0,onSubmit:function(t){t.preventDefault(),c(E({response:{data:{}}})),function(e,t){return function(s){s(E({response:{data:{}}})),y.a.post("/api/auth/register",e).then((function(e){return t.push("/login")})).catch((function(e){return s(E(e))}))}}({name:r.current.value,email:i.current.value,password:l.current.value,password2:o.current.value},e.history)(c)},children:[Object(x.jsxs)("div",{className:"input-field col s12",children:[Object(x.jsx)("input",{ref:r,error:n.name,name:"name",type:"text",className:L()("",{invalid:n.name})}),Object(x.jsx)("label",{htmlFor:"name",children:"Name"}),Object(x.jsx)("span",{className:"red-text",children:n.name})]}),Object(x.jsxs)("div",{className:"input-field col s12",children:[Object(x.jsx)("input",{ref:i,error:n.email,name:"email",type:"email",className:L()("",{invalid:n.email})}),Object(x.jsx)("label",{htmlFor:"email",children:"Email"}),Object(x.jsx)("span",{className:"red-text",children:n.email})]}),Object(x.jsxs)("div",{className:"input-field col s12",children:[Object(x.jsx)("input",{ref:l,error:n.password,name:"password",type:"password",className:L()("",{invalid:n.password})}),Object(x.jsx)("label",{htmlFor:"password",children:"Password"}),Object(x.jsx)("span",{className:"red-text",children:n.password})]}),Object(x.jsxs)("div",{className:"input-field col s12",children:[Object(x.jsx)("input",{ref:o,error:n.password2,name:"password2",type:"password",className:L()("",{invalid:n.password2})}),Object(x.jsx)("label",{htmlFor:"password2",children:"Confirm Password"}),Object(x.jsx)("span",{className:"red-text",children:n.password2})]}),Object(x.jsx)("div",{className:"col s12",style:{paddingLeft:"11.250px"},children:Object(x.jsx)("button",{className:"btn btn-large waves-effect waves-light hoverable blue accent-3",style:{width:"150px",borderRadius:"3px",letterSpacing:"1.5px",marginTop:"1rem"},type:"submit",children:"Sign Up"})})]})]})})})},D=function(e){var t=Object(a.useContext)(m),s=t.state,c=t.dispatch,n=s.error,r=Object(a.useRef)(),i=Object(a.useRef)();Object(a.useEffect)((function(){s.auth.isAuthenticated&&e.history.push("/dashboard")}),[s,e]);return Object(x.jsx)("div",{className:"container",children:Object(x.jsx)("div",{className:"row",style:{marginTop:"4rem"},children:Object(x.jsxs)("div",{className:"col s8 offset-s2",children:[Object(x.jsxs)(f.b,{to:"/",className:"btn-flat waves-effect",children:[Object(x.jsx)("i",{className:"material-icons left",children:"keyboard_backspace"})," Back to home"]}),Object(x.jsxs)("div",{className:"col s12",style:{paddingLeft:"11.250px"},children:[Object(x.jsxs)("h4",{children:[Object(x.jsx)("b",{children:"Login"})," below"]}),Object(x.jsxs)("p",{className:"grey-text text-darken-1",children:["Don't have an account? ",Object(x.jsx)(f.b,{to:"/register",children:"Register"})]})]}),Object(x.jsxs)("form",{noValidate:!0,onSubmit:function(t){t.preventDefault(),c(E({response:{data:{}}})),function(e,t){return function(s){s(E({response:{data:{}}})),y.a.post("/api/auth/login",e).then((function(e){var a=e.data.token;localStorage.setItem("jwtToken",a),R(a);var c=w()(a);s(k(c)),t.push("/")})).catch((function(e){return s(E(e))}))}}({email:r.current.value,password:i.current.value},e.history)(c)},children:[Object(x.jsxs)("div",{className:"input-field col s12",children:[Object(x.jsx)("input",{ref:r,error:n.incorrect,name:"email",type:"email",className:L()("",{invalid:n.incorrect})}),Object(x.jsx)("label",{htmlFor:"email",children:"Email"}),Object(x.jsx)("span",{className:"red-text",children:n.incorrect})]}),Object(x.jsxs)("div",{className:"input-field col s12",children:[Object(x.jsx)("input",{ref:i,error:n.incorrect,name:"password",type:"password",className:L()("",{invalid:n.incorrect})}),Object(x.jsx)("label",{htmlFor:"password",children:"Password"})]}),Object(x.jsx)("div",{className:"col s12",children:Object(x.jsx)("span",{className:"red-text",children:n.message})}),Object(x.jsx)("div",{className:"col s12",style:{paddingLeft:"11.250px"},children:Object(x.jsx)("button",{className:"btn btn-large waves-effect waves-light hoverable blue accent-3",style:{width:"150px",borderRadius:"3px",letterSpacing:"1.5px",marginTop:"1rem"},type:"submit",children:"Login"})})]})]})})})},P=s(33),U=function(e){var t=e.component,s=Object(P.a)(e,["component"]),c=Object(a.useContext)(m).state;return Object(x.jsx)(v.b,Object(i.a)(Object(i.a)({},s),{},{render:function(e){return!0===c.auth.isAuthenticated?Object(x.jsx)(t,Object(i.a)({},e)):Object(x.jsx)(v.a,{to:"/login"})}}))},_={getUser:function(){return y.a.get("/api/users/me")}},B=function(e){var t=Object(a.useContext)(m),s=t.state,c=t.dispatch,n=s.auth.user;Object(a.useEffect)((function(){s.auth.isAuthenticated||e.history.push("/login"),_.getUser().then((function(e){return console.log({res:e})})).catch((function(e){return console.log({err:e})}))}),[s,e]);return Object(x.jsx)("div",{className:"container valign-wrapper",style:{height:"75vh"},children:Object(x.jsx)("div",{className:"row",children:Object(x.jsxs)("div",{className:"col s12 center-align",children:[Object(x.jsxs)("h4",{children:[Object(x.jsx)("b",{children:"Hey there,"})," ",n.name.split(" ")[0],Object(x.jsxs)("p",{className:"flow-text grey-text text-darken-1",children:["You are logged into a full-stack"," "," ",Object(x.jsx)("span",{style:{fontFamily:"monospace"},children:"MERN"})," app"]})]}),Object(x.jsx)("button",{className:"btn btn-large waves-effect waves-light hoverable blue accent-3",style:{width:"150px",borderRadius:"3px",letterSpacing:"1.5px",marginTop:"1rem"},onClick:function(t){t.preventDefault(),S(e.history)(c)},children:"Logout"})]})})})},I=function(){var e=Object(a.useContext)(m).dispatch;return Object(a.useEffect)((function(){if(localStorage.jwtToken){var t=localStorage.jwtToken,s=w()(t),a=Date.now()/1e3;R(t),e(k(s)),s.exp<a&&(e(S()),window.location.href="./login")}}),[e]),Object(x.jsx)(f.a,{children:Object(x.jsxs)("div",{className:"App",children:[Object(x.jsx)(C,{}),Object(x.jsx)(v.b,{exact:!0,path:"/",component:T}),Object(x.jsx)(v.b,{exact:!0,path:"/register",component:A}),Object(x.jsx)(v.b,{exact:!0,path:"/login",component:D}),Object(x.jsx)(v.d,{children:Object(x.jsx)(U,{exact:!0,path:"/dashboard",component:B})})]})})},z=function(e){e&&e instanceof Function&&s.e(3).then(s.bind(null,66)).then((function(t){var s=t.getCLS,a=t.getFID,c=t.getFCP,n=t.getLCP,r=t.getTTFB;s(e),a(e),c(e),n(e),r(e)}))};Object(c.render)(Object(x.jsx)(O,{children:Object(x.jsx)(I,{})}),document.getElementById("root")),z()}},[[65,1,2]]]);
//# sourceMappingURL=main.8638911f.chunk.js.map